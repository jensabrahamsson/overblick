/* ================================================
   Överblick Setup Wizard — Dark Theme
   Extends the dashboard color palette
   ================================================ */

/* --- Reset & Base (same as dashboard) --- */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
    /* Colors — inherited from dashboard palette */
    --bg-primary: #0d1117;
    --bg-secondary: #161b22;
    --bg-tertiary: #21262d;
    --bg-card: #161b22;
    --bg-input: #0d1117;
    --border: #30363d;
    --border-focus: #58a6ff;

    --text-primary: #e6edf3;
    --text-secondary: #8b949e;
    --text-muted: #9198a1;  /* WCAG AA 4.5:1 on --bg-card */
    --text-link: #58a6ff;

    --accent: #58a6ff;
    --accent-hover: #79c0ff;
    --green: #3fb950;
    --green-dim: #238636;
    --red: #f97583;         /* WCAG AA 4.5:1 on --bg-card */
    --red-dim: #da3633;
    --amber: #d29922;
    --amber-dim: #9e6a03;
    --orange: #ff8c42;
    --purple: #bc8cff;

    /* Brand identity — Överblick signature gradient */
    --brand-from: #58a6ff;
    --brand-to: #bc8cff;
    --brand-gradient: linear-gradient(135deg, var(--brand-from), var(--brand-to));

    /* Setup-specific colors */
    --glow: rgba(88, 166, 255, 0.15);
    --glow-strong: rgba(88, 166, 255, 0.3);
    --card-selected: rgba(63, 185, 80, 0.12);
    --card-selected-border: var(--green);

    /* Personality accent colors */
    --color-anomal: #f85149;
    --color-cherry: #ff6b9d;
    --color-blixt: #58a6ff;
    --color-bjork: #3fb950;
    --color-prisma: #bc8cff;
    --color-rost: #ff8c42;
    --color-natt: #7c83db;
    --color-stal: #8b949e;

    /* Spacing */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2rem;
    --space-2xl: 3rem;

    /* Radius */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;

    /* Fonts */
    --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
    --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;

    /* Shadows */
    --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.3), 0 0 0 1px var(--border);
    --shadow-hover: 0 4px 12px rgba(0, 0, 0, 0.4), 0 0 0 1px var(--border-focus);
    --shadow-glow: 0 0 20px var(--glow), 0 0 40px rgba(88, 166, 255, 0.05);
}

html {
    font-size: 15px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: var(--font-sans);
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.5;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    /* Subtle dot grid background — distinctive brand texture */
    background-image: radial-gradient(circle, rgba(88, 166, 255, 0.03) 1px, transparent 1px);
    background-size: 24px 24px;
}

/* Brand accent bar — distinctive Överblick identity */
body::before {
    content: '';
    display: block;
    height: 3px;
    background: var(--brand-gradient);
    flex-shrink: 0;
}

a { color: var(--text-link); text-decoration: none; }
a:hover { color: var(--accent-hover); text-decoration: underline; }

/* --- Focus & Accessibility --- */
a:focus-visible, button:focus-visible, input:focus-visible,
select:focus-visible, textarea:focus-visible, [tabindex]:focus-visible {
    outline: 2px solid var(--border-focus);
    outline-offset: 2px;
}

/* High Contrast Mode: ensure focus is always visible via outline (box-shadow is ignored) */
@media (forced-colors: active) {
    *:focus-visible {
        outline: 2px solid LinkText;
        outline-offset: 2px;
    }
    .character-card.focused {
        outline: 2px solid Highlight;
        outline-offset: 2px;
    }
    .progress-step.active {
        outline: 2px solid Highlight;
    }
}

.sr-only {
    position: absolute; width: 1px; height: 1px;
    padding: 0; margin: -1px; overflow: hidden;
    clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
}

/* ================================================
   Layout
   ================================================ */

.setup-container {
    max-width: 800px;
    margin: 0 auto;
    padding: var(--space-xl) var(--space-lg);
    flex: 1;
    width: 100%;
}

.setup-header {
    text-align: center;
    padding: var(--space-2xl) 0 var(--space-lg);
}

.setup-logo {
    width: 80px;
    height: 80px;
    margin-bottom: var(--space-md);
    filter: drop-shadow(0 0 12px var(--glow));
    animation: logo-glow 3s ease-in-out infinite alternate;
}

@keyframes logo-glow {
    from { filter: drop-shadow(0 0 8px var(--glow)); }
    to { filter: drop-shadow(0 0 20px var(--glow-strong)); }
}

.setup-title {
    font-size: 2rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    margin-bottom: var(--space-xs);
    background: var(--brand-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.setup-subtitle {
    color: var(--text-secondary);
    font-size: 1.1rem;
}

.setup-version {
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-top: var(--space-xs);
}

/* ================================================
   Progress Bar
   ================================================ */

.progress-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: var(--space-xl) 0 var(--space-2xl);
    padding-bottom: var(--space-lg); /* room for step name labels */
    position: relative;
}

.progress-bar::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--border);
    transform: translateY(-50%);
    z-index: 0;
}

/* Gradient fill showing completed progress */
.progress-bar::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    height: 2px;
    background: var(--brand-gradient);
    transform: translateY(-50%);
    z-index: 0;
    width: var(--progress-pct, 0%);
    transition: width 0.4s ease;
}

.progress-step {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--bg-tertiary);
    border: 2px solid var(--border);
    color: var(--text-muted);
    font-size: 0.8rem;
    font-weight: 600;
    z-index: 1;
    transition: all 0.3s ease;
}

.progress-step.active {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--bg-primary);
    box-shadow: 0 0 12px var(--glow);
}

.progress-step.completed {
    background: var(--green-dim);
    border-color: var(--green);
    color: white;
}

/* Step name labels — always visible for accessibility (no hover-only information) */
.progress-step {
    position: relative;
}

.progress-step::after {
    content: attr(title);
    position: absolute;
    top: calc(100% + 6px);
    left: 50%;
    transform: translateX(-50%);
    color: var(--text-muted);
    font-size: 0.65rem;
    font-weight: 500;
    white-space: nowrap;
    pointer-events: none;
    transition: color 0.2s, opacity 0.2s;
    z-index: 10;
    opacity: 0.6;
}

/* Active step label is prominent */
.progress-step.active::after {
    color: var(--accent);
    opacity: 1;
    font-weight: 600;
}

/* Completed step labels use green */
.progress-step.completed::after {
    color: var(--green);
    opacity: 0.7;
}

/* Hover enhances any step label */
.progress-step:hover::after {
    opacity: 1;
}

/* ================================================
   Step Content
   ================================================ */

.step-content {
    animation: fade-in 0.4s ease-out;
}

@keyframes fade-in {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.step-heading {
    font-size: 1.6rem;
    font-weight: 700;
    margin-bottom: var(--space-sm);
}

.step-description {
    color: var(--text-secondary);
    margin-bottom: var(--space-xl);
    line-height: 1.6;
}

/* ================================================
   Forms
   ================================================ */

.form-group {
    margin-bottom: var(--space-lg);
}

.form-label {
    display: block;
    font-weight: 600;
    margin-bottom: var(--space-sm);
    color: var(--text-primary);
}

.form-hint {
    display: block;
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-bottom: var(--space-sm);
}

.form-input,
.form-select,
.form-textarea {
    width: 100%;
    padding: 10px 14px;
    background: var(--bg-input);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    color: var(--text-primary);
    font-family: inherit;
    font-size: 0.95rem;
    transition: border-color 0.2s;
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    border-color: var(--border-focus);
    box-shadow: 0 0 0 3px var(--glow);
}

.form-input::placeholder {
    color: var(--text-muted);
}

/* Range slider */
.form-range {
    width: 100%;
    -webkit-appearance: none;
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    outline: none;
}

.form-range::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
    border: 2px solid var(--bg-primary);
}

.form-range-value {
    font-family: var(--font-mono);
    color: var(--accent);
    font-weight: 600;
    font-size: 0.9rem;
}

/* Radio cards */
.radio-cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-md);
}

.radio-card {
    display: block;
    padding: var(--space-lg);
    background: var(--bg-card);
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.radio-card:hover {
    border-color: var(--accent);
    box-shadow: var(--shadow-hover);
}

.radio-card input[type="radio"] {
    position: absolute;
    width: 1px;
    height: 1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    clip-path: inset(50%);
    white-space: nowrap;
}

.radio-card:has(input:focus-visible) {
    outline: 2px solid var(--border-focus);
    outline-offset: 2px;
}

.radio-card:has(input:checked) {
    border-color: var(--accent);
    background: rgba(88, 166, 255, 0.08);
    box-shadow: 0 0 12px var(--glow);
}

.radio-card-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: var(--space-xs);
}

.radio-card-desc {
    color: var(--text-secondary);
    font-size: 0.85rem;
}

/* Toggle switch */
.toggle-section {
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-lg);
    overflow: hidden;
}

.toggle-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-md) var(--space-lg);
    background: var(--bg-secondary);
    cursor: pointer;
}

.toggle-header-title {
    font-weight: 600;
    font-size: 1.05rem;
}

.toggle-body {
    padding: var(--space-lg);
    display: none;
}

.toggle-body.open {
    display: block;
}

.toggle-switch {
    position: relative;
    width: 44px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background: var(--bg-tertiary);
    border-radius: 12px;
    transition: 0.3s;
    border: 1px solid var(--border);
}

.toggle-slider::before {
    content: '';
    position: absolute;
    height: 18px;
    width: 18px;
    left: 2px;
    bottom: 2px;
    background: var(--text-muted);
    border-radius: 50%;
    transition: 0.3s;
}

.toggle-switch input:checked + .toggle-slider {
    background: var(--green-dim);
    border-color: var(--green);
}

.toggle-switch input:checked + .toggle-slider::before {
    transform: translateX(20px);
    background: white;
}

/* ================================================
   Buttons
   ================================================ */

.btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    padding: 10px 24px;
    border-radius: var(--radius-md);
    font-family: inherit;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    border: 1px solid transparent;
    transition: all 0.2s;
    text-decoration: none;
}

.btn-primary {
    background: var(--accent);
    color: var(--bg-primary);
    border-color: var(--accent);
}

.btn-primary:hover {
    background: var(--accent-hover);
    border-color: var(--accent-hover);
    text-decoration: none;
    color: var(--bg-primary);
}

.btn-secondary {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border-color: var(--border);
}

.btn-secondary:hover {
    border-color: var(--text-muted);
    text-decoration: none;
}

.btn-large {
    padding: 14px 40px;
    font-size: 1.1rem;
    border-radius: var(--radius-lg);
}

.btn-success {
    background: var(--green);
    color: var(--bg-primary);
    border-color: var(--green);
    font-weight: 700;
}

.btn-success:hover {
    background: #2ea043;
    border-color: #2ea043;
    text-decoration: none;
    color: var(--bg-primary);
}

.btn-test {
    padding: 6px 16px;
    font-size: 0.85rem;
}

.btn-group {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--space-2xl);
    padding-top: var(--space-lg);
    border-top: 1px solid var(--border);
}

/* Sticky variant — keeps buttons visible on long pages (e.g. character select) */
.btn-group-sticky {
    position: sticky;
    bottom: 0;
    background: var(--bg-primary);
    padding-bottom: var(--space-lg);
    z-index: 20;
}

/* ================================================
   Badges
   ================================================ */

.badge {
    display: inline-block;
    padding: 2px 10px;
    border-radius: 10px;
    font-size: 0.8rem;
    font-weight: 600;
}

.badge-green { background: var(--green-dim); color: var(--green); }
.badge-red { background: var(--red-dim); color: var(--red); }
.badge-amber { background: var(--amber-dim); color: var(--amber); }
.badge-purple { background: rgba(188, 140, 255, 0.15); color: var(--purple); }
.badge-muted { background: var(--bg-tertiary); color: var(--text-secondary); }

.test-result {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    margin-left: var(--space-sm);
}

.test-detail {
    color: var(--text-muted);
    font-size: 0.8rem;
    margin-left: var(--space-sm);
}

/* ================================================
   Character Carousel (Step 5)
   ================================================ */

.carousel-container {
    position: relative;
    overflow: hidden;
    padding: var(--space-xl) 0;
}

.carousel-track {
    display: flex;
    align-items: center;
    gap: var(--space-lg);
    transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    min-height: 400px;
    /* Scroll snap for smooth mobile experience */
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-padding-inline: calc(50% - 180px); /* center focused card (half of 360px) */
    scrollbar-width: none; /* hide scrollbar */
    -ms-overflow-style: none;
    /* Pad edges so first/last card can scroll to center */
    padding-inline: max(var(--space-xl), calc(50% - 180px));
}

.carousel-track::-webkit-scrollbar {
    display: none;
}

/* Focus outline when keyboard-navigating the listbox */
.carousel-track:focus-visible {
    outline: 2px solid var(--border-focus);
    outline-offset: 4px;
    border-radius: var(--radius-lg);
}

.carousel-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    color: var(--text-primary);
    font-size: 1.4rem;
    cursor: pointer;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.carousel-nav:hover {
    background: var(--bg-secondary);
    border-color: var(--accent);
    color: var(--accent);
}

.carousel-nav-prev { left: 0; }
.carousel-nav-next { right: 0; }

/* Character cards */
.character-card {
    flex-shrink: 0;
    width: 280px;
    padding: var(--space-lg);
    background: var(--bg-card);
    border: 2px solid var(--border);
    border-radius: var(--radius-xl);
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    opacity: 0.5;
    transform: scale(0.85);
    cursor: pointer;
    position: relative;
    scroll-snap-align: center;
}

.character-card.focused {
    width: 360px;
    opacity: 1;
    transform: scale(1);
    border-color: var(--card-accent, var(--accent));
    box-shadow: 0 0 20px rgba(var(--card-accent-rgb, 88, 166, 255), 0.2),
                0 0 40px rgba(var(--card-accent-rgb, 88, 166, 255), 0.05);
    z-index: 5;
}

/* Per-personality accent colors on cards */
.character-card[data-name="anomal"]  { --card-accent: var(--color-anomal); --card-accent-rgb: 248, 81, 73; }
.character-card[data-name="cherry"]  { --card-accent: var(--color-cherry); --card-accent-rgb: 255, 107, 157; }
.character-card[data-name="blixt"]   { --card-accent: var(--color-blixt);  --card-accent-rgb: 88, 166, 255; }
.character-card[data-name="bjork"]   { --card-accent: var(--color-bjork);  --card-accent-rgb: 63, 185, 80; }
.character-card[data-name="prisma"]  { --card-accent: var(--color-prisma); --card-accent-rgb: 188, 140, 255; }
.character-card[data-name="rost"]    { --card-accent: var(--color-rost);   --card-accent-rgb: 255, 140, 66; }
.character-card[data-name="natt"]    { --card-accent: var(--color-natt);   --card-accent-rgb: 124, 131, 219; }
.character-card[data-name="stal"]    { --card-accent: var(--color-stal);    --card-accent-rgb: 139, 148, 158; }

/* Personality color name accent */
.character-card.focused .character-name {
    color: var(--card-accent, var(--text-primary));
}

.character-card.selected {
    border-color: var(--card-selected-border);
    background: var(--card-selected);
}

.character-card.selected.focused {
    box-shadow: 0 0 20px rgba(63, 185, 80, 0.2), 0 0 40px rgba(63, 185, 80, 0.05);
}

.character-avatar {
    width: 64px;
    height: 64px;
    margin: 0 auto var(--space-md);
    display: block;
    filter: drop-shadow(0 0 8px var(--glow));
}

.character-card.focused .character-avatar {
    width: 80px;
    height: 80px;
}

.character-name {
    font-size: 1.3rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: var(--space-xs);
}

.character-role {
    color: var(--text-secondary);
    text-align: center;
    font-size: 0.85rem;
    margin-bottom: var(--space-lg);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Trait bars */
.trait-bars {
    margin-bottom: var(--space-lg);
}

.trait-bar {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-sm);
}

.trait-label {
    font-size: 0.8rem;
    color: var(--text-secondary);
    width: 100px;
    text-transform: capitalize;
}

.trait-track {
    flex: 1;
    height: 6px;
    background: var(--bg-tertiary);
    border-radius: 3px;
    overflow: hidden;
}

.trait-fill {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, var(--card-accent, var(--accent)), color-mix(in srgb, var(--card-accent, var(--accent)) 60%, var(--purple)));
    transition: width 0.6s ease-out;
}

.trait-value {
    font-family: var(--font-mono);
    font-size: 0.78rem;
    color: var(--text-secondary);
    width: 40px;
    text-align: right;
    font-weight: 600;
}

/* Plugin compatibility */
.plugin-list {
    margin-bottom: var(--space-md);
}

.plugin-title {
    font-size: 0.78rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--space-xs);
    font-weight: 600;
}

.plugin-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: 0.85rem;
    margin-bottom: var(--space-xs);
    width: 100%;
}

.plugin-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}

.plugin-dot.great { background: var(--green); }
.plugin-dot.good { background: var(--amber); }
.plugin-dot.na { background: var(--text-muted); }

.plugin-level {
    margin-left: auto;
    font-size: 0.75rem;
    color: var(--text-muted);
    font-weight: 500;
}

/* Sample quote */
.character-quote {
    font-style: italic;
    color: var(--text-muted);
    font-size: 0.85rem;
    border-left: 2px solid var(--border);
    padding-left: var(--space-md);
    margin-bottom: var(--space-lg);
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Select button */
.character-select-btn {
    width: 100%;
    padding: 8px;
    border-radius: var(--radius-md);
    border: 1px solid var(--border);
    background: var(--bg-tertiary);
    color: var(--text-primary);
    font-family: inherit;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.character-select-btn:hover {
    border-color: var(--green);
    background: var(--green-dim);
}

.character-select-btn.active {
    background: var(--green);
    border-color: var(--green);
    color: var(--bg-primary);
    font-weight: 700;
}

/* Selection counter */
.selection-counter {
    text-align: center;
    padding: var(--space-md);
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.selection-counter strong {
    color: var(--accent);
}

/* ================================================
   Review Cards (Step 7)
   ================================================ */

.review-section {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-lg);
    margin-bottom: var(--space-lg);
}

.review-section-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: var(--space-md);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.review-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-sm) 0;
    border-bottom: 1px solid var(--border);
}

.review-item:last-child {
    border-bottom: none;
}

.review-label {
    color: var(--text-secondary);
}

.review-value {
    font-weight: 600;
}

.review-edit {
    font-size: 0.85rem;
    margin-left: var(--space-sm);
}

/* ================================================
   Use Case Cards (Step 5)
   ================================================ */

.use-case-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-lg);
}

.use-case-card {
    cursor: pointer;
    display: block;
}

.use-case-card input[type="checkbox"] {
    position: absolute;
    width: 1px;
    height: 1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    clip-path: inset(50%);
    white-space: nowrap;
}

.use-case-card-inner {
    padding: var(--space-lg);
    background: var(--bg-card);
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    transition: all 0.2s;
    height: 100%;
}

.use-case-card-inner:hover {
    border-color: var(--accent);
    box-shadow: var(--shadow-hover);
}

.use-case-card input:focus-visible + .use-case-card-inner {
    outline: 2px solid var(--border-focus);
    outline-offset: 2px;
}

.use-case-card input:checked + .use-case-card-inner {
    border-color: var(--green);
    background: var(--card-selected);
    box-shadow: 0 0 12px rgba(63, 185, 80, 0.15);
}

.use-case-icon {
    font-size: 2rem;
    margin-bottom: var(--space-sm);
    line-height: 1;
}

.use-case-name {
    font-size: 1.15rem;
    font-weight: 700;
    margin-bottom: var(--space-xs);
}

.use-case-desc {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: var(--space-md);
    line-height: 1.5;
}

.use-case-plugins {
    display: flex;
    gap: var(--space-xs);
    flex-wrap: wrap;
}

.use-case-warning {
    margin-top: var(--space-sm);
    font-size: 0.85rem;
    color: var(--amber);
    padding: var(--space-xs) var(--space-sm);
    background: rgba(210, 153, 34, 0.1);
    border-radius: var(--radius-sm);
}

.use-case-warning a {
    color: var(--amber);
    text-decoration: underline;
}

/* ================================================
   Agent Assignment (Step 6)
   ================================================ */

.assignment-section {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-lg);
    margin-bottom: var(--space-lg);
}

.assignment-header {
    display: flex;
    align-items: flex-start;
    gap: var(--space-md);
    margin-bottom: var(--space-lg);
}

.assignment-header-icon {
    font-size: 1.8rem;
    flex-shrink: 0;
    line-height: 1;
}

.assignment-header-name {
    font-size: 1.1rem;
    font-weight: 700;
}

.assignment-header-desc {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.auto-assigned {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-md);
    flex-wrap: wrap;
}

.assignment-role {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.personality-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: var(--space-sm);
    margin-bottom: var(--space-md);
}

.personality-option {
    cursor: pointer;
    display: block;
}

.personality-option input[type="radio"] {
    position: absolute;
    width: 1px;
    height: 1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    clip-path: inset(50%);
    white-space: nowrap;
}

.personality-option-inner {
    padding: var(--space-md);
    background: var(--bg-secondary);
    border: 2px solid var(--border);
    border-radius: var(--radius-md);
    transition: all 0.2s;
    height: 100%;
}

.personality-option-inner:hover {
    border-color: var(--accent);
}

.personality-option input:focus-visible + .personality-option-inner {
    outline: 2px solid var(--border-focus);
    outline-offset: 2px;
}

.personality-option input:checked + .personality-option-inner {
    border-color: var(--accent);
    background: rgba(88, 166, 255, 0.08);
    box-shadow: 0 0 8px var(--glow);
}

.personality-option-name {
    font-weight: 700;
    margin-bottom: var(--space-xs);
}

.personality-option-role {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin-bottom: var(--space-xs);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.assignment-config {
    margin-top: var(--space-md);
}

.assignment-config-summary {
    color: var(--text-muted);
    font-size: 0.9rem;
    cursor: pointer;
    padding: var(--space-sm) 0;
    user-select: none;
}

.assignment-config-summary:hover {
    color: var(--text-secondary);
}

.assignment-config-body {
    padding: var(--space-md) 0;
}

/* ================================================
   Success / Celebration (Step 8)
   ================================================ */

.success-container {
    text-align: center;
    padding: var(--space-2xl) 0;
}

.checkmark-circle {
    width: 100px;
    height: 100px;
    margin: 0 auto var(--space-xl);
    border-radius: 50%;
    background: var(--green-dim);
    display: flex;
    align-items: center;
    justify-content: center;
    animation: checkmark-pop 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
}

@keyframes checkmark-pop {
    0% { transform: scale(0); opacity: 0; }
    70% { transform: scale(1.1); }
    100% { transform: scale(1); opacity: 1; }
}

/* Animated SVG checkmark — stroke-dasharray draw animation */
.checkmark-svg {
    width: 64px;
    height: 64px;
}

.checkmark-ring {
    stroke-dasharray: 151; /* circle circumference: 2 * π * 24 ≈ 151 */
    stroke-dashoffset: 151;
    animation: checkmark-ring-draw 0.6s 0.2s ease-out forwards;
    opacity: 0.35;
}

.checkmark-check {
    stroke-dasharray: 40;
    stroke-dashoffset: 40;
    animation: checkmark-draw 0.4s 0.6s ease-out forwards;
}

@keyframes checkmark-ring-draw {
    to { stroke-dashoffset: 0; }
}

@keyframes checkmark-draw {
    to { stroke-dashoffset: 0; }
}

.success-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: var(--space-md);
}

.success-subtitle {
    color: var(--text-secondary);
    font-size: 1.1rem;
    margin-bottom: var(--space-xl);
}

.success-agents {
    display: flex;
    justify-content: center;
    gap: var(--space-md);
    flex-wrap: wrap;
    margin-bottom: var(--space-2xl);
}

.success-agent-badge {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: 8px 16px;
    background: var(--bg-card);
    border: 1px solid var(--green);
    border-radius: 20px;
    font-weight: 600;
    color: var(--green);
    animation: badge-pop 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) backwards;
}

.success-agent-badge:nth-child(1) { animation-delay: 0.2s; }
.success-agent-badge:nth-child(2) { animation-delay: 0.4s; }
.success-agent-badge:nth-child(3) { animation-delay: 0.6s; }
.success-agent-badge:nth-child(4) { animation-delay: 0.8s; }
.success-agent-badge:nth-child(5) { animation-delay: 1.0s; }

@keyframes badge-pop {
    0% { transform: scale(0); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}

.success-agent-icon {
    width: 24px;
    height: 24px;
    filter: drop-shadow(0 0 4px rgba(63, 185, 80, 0.3));
}

.created-files {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-lg);
    text-align: left;
    margin-bottom: var(--space-2xl);
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
}

.created-files-title {
    font-weight: 700;
    margin-bottom: var(--space-md);
    cursor: pointer;
    color: var(--text-secondary);
}

.created-files-title:hover {
    color: var(--text-primary);
}

.created-files[open] .created-files-title {
    margin-bottom: var(--space-md);
}

.created-file {
    font-family: var(--font-mono);
    font-size: 0.85rem;
    color: var(--green);
    padding: var(--space-xs) 0;
}

/* Command blocks */
.command-block {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    padding: var(--space-md) var(--space-lg);
    margin-bottom: var(--space-md);
    text-align: left;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
}

.command-label {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: var(--space-xs);
}

.command-text {
    font-family: var(--font-mono);
    font-size: 0.9rem;
    color: var(--accent);
}

/* Confetti (subtle CSS particles) */
.confetti {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 100;
    overflow: hidden;
}

.confetti-piece {
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 2px;
    animation: confetti-fall 3s ease-out forwards;
    opacity: 0;
}

@keyframes confetti-fall {
    0% { opacity: 1; transform: translateY(-20px) rotate(0deg); }
    100% { opacity: 0; transform: translateY(100vh) rotate(720deg); }
}

/* ================================================
   Music Controls
   ================================================ */

.music-pill {
    position: fixed;
    bottom: var(--space-lg);
    right: var(--space-lg);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: 8px 14px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 20px;
    z-index: 50;
    transition: opacity 0.3s;
}

.music-btn {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 1.1rem;
    padding: 2px;
    display: flex;
    align-items: center;
    transition: color 0.2s;
}

.music-btn:hover {
    color: var(--accent);
}

.music-btn.playing {
    color: var(--green);
}

/* Pulse animation for autoplay-blocked hint */
.music-btn {
    animation: none;
}

@keyframes pulse {
    0%, 100% {
        opacity: 0.6;
        box-shadow: 0 0 0 0 rgba(88, 166, 255, 0.4);
    }
    50% {
        opacity: 1;
        box-shadow: 0 0 0 8px rgba(88, 166, 255, 0);
    }
}

.music-volume {
    width: 60px;
    height: 4px;
    -webkit-appearance: none;
    background: var(--border);
    border-radius: 2px;
    outline: none;
}

.music-volume::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
}

/* ================================================
   Welcome Animations
   ================================================ */

.welcome-fade {
    animation: welcome-appear 0.8s ease-out;
}

@keyframes welcome-appear {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.welcome-description {
    max-width: 600px;
    margin: 0 auto var(--space-xl);
    color: var(--text-secondary);
    font-size: 1.05rem;
    line-height: 1.7;
}

.welcome-credit {
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-bottom: var(--space-xl);
}

/* ================================================
   Error Messages
   ================================================ */

.flash-error {
    background: rgba(248, 81, 73, 0.1);
    border: 1px solid var(--red-dim);
    color: var(--red);
    padding: var(--space-md) var(--space-lg);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-lg);
}

/* Inline field error (aria-describedby target) */
.field-error {
    color: var(--red);
    font-size: 0.85rem;
    margin-top: var(--space-xs);
}

.form-input.error,
.form-select.error {
    border-color: var(--red);
}

.form-input.error:focus,
.form-select.error:focus {
    box-shadow: 0 0 0 3px rgba(248, 81, 73, 0.15);
}

/* ================================================
   Skip Link (optional steps)
   ================================================ */

.skip-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    color: var(--text-muted);
    font-size: 0.85rem;
    transition: color 0.2s;
}

.skip-link:hover {
    color: var(--text-secondary);
    text-decoration: none;
}

/* ================================================
   Loading / Processing State
   ================================================ */

.btn-loading {
    position: relative;
    pointer-events: none;
    opacity: 0.85;
}

.btn-loading::after {
    content: '';
    position: absolute;
    width: 18px;
    height: 18px;
    border: 2px solid transparent;
    border-top-color: currentColor;
    border-radius: 50%;
    animation: btn-spin 0.6s linear infinite;
    margin-left: var(--space-sm);
}

@keyframes btn-spin {
    to { transform: rotate(360deg); }
}

.provisioning-overlay {
    position: fixed;
    inset: 0;
    background: rgba(13, 17, 23, 0.85);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 200;
    gap: var(--space-lg);
    backdrop-filter: blur(4px);
}

.provisioning-spinner {
    width: 48px;
    height: 48px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: btn-spin 0.8s linear infinite;
}

.provisioning-text {
    color: var(--text-secondary);
    font-size: 1.1rem;
    font-weight: 600;
}

/* ================================================
   Responsive
   ================================================ */

/* ================================================
   Carousel Position Indicator
   ================================================ */

.carousel-indicator {
    display: flex;
    justify-content: center;
    gap: 6px;
    padding: var(--space-md) 0;
}

.carousel-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--border);
    border: none;
    padding: 0;
    cursor: pointer;
    transition: all 0.3s;
}

.carousel-dot.active {
    background: var(--accent);
    transform: scale(1.3);
}

.carousel-dot.selected {
    background: var(--green);
}

/* ================================================
   Character Card Enhanced Hover
   ================================================ */

.character-card:hover {
    border-color: var(--text-muted);
    transform: scale(0.88);
}

.character-card.focused:hover {
    transform: scale(1.02);
    box-shadow: 0 0 30px rgba(var(--card-accent-rgb, 88, 166, 255), 0.3),
                0 0 60px rgba(var(--card-accent-rgb, 88, 166, 255), 0.08);
}

/* Selection pulse animation */
@keyframes select-pulse {
    0% { box-shadow: 0 0 0 0 rgba(63, 185, 80, 0.4); }
    70% { box-shadow: 0 0 0 12px rgba(63, 185, 80, 0); }
    100% { box-shadow: 0 0 0 0 rgba(63, 185, 80, 0); }
}

.character-card.just-selected {
    animation: select-pulse 0.6s ease-out;
}

/* ================================================
   Responsive
   ================================================ */

@media (max-width: 768px) {
    .setup-container {
        padding: var(--space-md);
    }

    .radio-cards,
    .use-case-grid {
        grid-template-columns: 1fr;
    }

    .personality-grid {
        grid-template-columns: 1fr 1fr;
    }

    .carousel-track {
        gap: var(--space-sm);
    }

    .character-card {
        width: 240px;
    }

    .character-card.focused {
        width: 300px;
    }

    .btn-group {
        flex-direction: column-reverse;
        gap: var(--space-md);
    }

    .btn-group .btn {
        width: 100%;
        justify-content: center;
        min-height: 48px; /* Touch target: 48px > WCAG 44px minimum */
    }

    /* Mobile progress bar: compact, hide step labels */
    .progress-step {
        width: 28px;
        height: 28px;
        font-size: 0.7rem;
    }

    .progress-step::after {
        display: none;
    }

    .progress-bar {
        padding-bottom: 0;
    }

    /* Mobile touch targets */
    .carousel-nav {
        width: 44px;
        height: 44px;
    }

    .character-select-btn {
        min-height: 48px;
        font-size: 1rem;
    }

    .btn-test {
        min-height: 44px;
    }

    .toggle-header {
        min-height: 48px;
    }
}

/* ================================================
   Step 8 — Completion Page
   ================================================ */

.completion-page {
    max-width: 640px;
    margin: 0 auto;
    text-align: center;
}

.completion-content {
    padding: var(--space-2xl) 0;
}

.completion-page .checkmark-circle {
    margin: 0 auto var(--space-lg);
}

.completion-subtitle {
    margin-top: var(--space-md);
}

.completion-tags {
    justify-content: center;
    margin: var(--space-lg) 0;
}

.completion-files {
    text-align: left;
    margin: var(--space-lg) 0;
}

.completion-files-summary {
    cursor: pointer;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.completion-files-list {
    margin-top: var(--space-sm);
}

.completion-file-path {
    font-size: 0.8rem;
    color: var(--text-secondary);
    padding: 2px 0;
}

.completion-actions {
    justify-content: center;
    margin-top: var(--space-xl);
}

/* ================================================
   Settings Utilities (extracted inline styles)
   ================================================ */

.settings-card-narrow { max-width: 640px; }
.settings-card-wide { max-width: 720px; }
.settings-backend-panel {
    padding: var(--space-md);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    margin-bottom: var(--space-md);
}
.settings-backend-panel--disabled { opacity: 0.5; }
.settings-checkbox-label {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    cursor: pointer;
}
.settings-checkbox-label--disabled { cursor: not-allowed; }
.settings-flex-row {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}
.settings-flex-grow { flex: 1; }
.settings-test-col { padding-top: 1.5rem; }
.settings-test-row { margin-top: var(--space-sm); }
.settings-grid-4col {
    display: grid;
    grid-template-columns: 1fr 2fr 1fr 2fr;
    gap: var(--space-sm);
    align-items: end;
}
.settings-grid-2col {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: var(--space-sm);
    align-items: end;
}
.settings-config-body { margin-top: var(--space-md); }
.settings-radio-group { display: flex; gap: var(--space-lg); }
.settings-radio-label { cursor: pointer; }
.form-separator { margin-bottom: var(--space-sm); }
.form-separator-lg { margin: var(--space-lg) 0 var(--space-sm); }
.form-hint-inline { margin: 0; }
.form-label-inline { margin-bottom: 0; }
.badge-sm { font-size: 0.7rem; }
.review-model-name { font-size: 0.85rem; }
.review-badge-ml { margin-left: 4px; }
.nav-link-sm { font-size: 0.9em; }
.dashboard-exit-link {
    position: absolute;
    top: 1rem;
    right: 1.5rem;
    color: var(--text-secondary, #8b949e);
    font-size: 0.9rem;
    text-decoration: none;
    opacity: 0.9;
    transition: all 0.2s;
    font-weight: 500;
}
.dashboard-exit-link:hover {
    opacity: 1;
    color: var(--accent, #58a6ff);
}
.form-start-btn { margin-top: var(--space-lg); }

/* ================================================
   Reduced Motion Preference
   ================================================ */

@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}
